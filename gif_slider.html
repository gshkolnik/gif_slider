<head>
<title>GIF Punch</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<style>
html,body{
    margin:0;
    height:100%;
    overflow:hidden;
}

img,video {
    display:block;
    width:auto;
    height:100%;
    object-fit: cover;
    margin:auto;
}
</style>
</head>

<body>
<div id="gif">
</div>

<script>

function image_load_error(gif) {
  console.log("Failed to load: " + gif)
  show_gif()
}

function show_gif() {
  gif=gifs[Math.floor(Math.random() * (gifs.length - 1))]

  show_html = ""
  if (/mp4$/.test(gif) || /webm$/.test(gif) || /gifv$/.test(gif)) {

    video_gif = gif
    if (/gifv$/.test(gif)) {
      video_gif = gif.substring(0, gif.length - 4) + "mp4"
    }

  show_html =
      "<video \
        preload=\"auto\" autoplay=\"autoplay\" loop=\"loop\"> \
        <source \
          src=\"" + video_gif + "\" type=\"video/webm\" \
          onerror=\"image_load_error(&quot;" + gif + "&quot;);\"> \
      </video>"
  }
  else if (/gif$/.test(gif)) {
    show_html =
        "<img onerror=\"image_load_error(&quot;" + gif + "&quot;);\" src=\"" + gif + "\">"
  }

  $("#gif").html(show_html)
}

var gifs=[]
jQuery.get('https://s3.amazonaws.com/gsh-gifs/gifs.txt',
    function(data) {
        gifs = (String(data)).split('\n');
        show_gif()
    });
setInterval(show_gif, 10000)

</script>
</body>
